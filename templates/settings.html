<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Configure settings for AI Video Ads Generator">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Video Gen">
    <title>Settings - AI Video Ads Generator</title>
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="content-wrapper">
    <div class="top-header">
        <h1 class="h5 mb-0">‚öôÔ∏è Settings</h1>
    </div>

    <div class="container my-5">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="card shadow-lg">
                    <div class="card-body p-4">
                        <h2 class="card-title mb-4">‚öôÔ∏è Settings</h2>

                        <form id="settingsForm">
                            <!-- API Keys Section -->
                            <div class="mb-5">
                                <h5 class="mb-3">üîë API Keys</h5>

                                <div class="mb-4">
                                    <label for="openaiKey" class="form-label fw-bold">OpenAI API Key (Sora)</label>
                                    <input type="password" class="form-control" id="openaiKey" name="openai_api_key" 
                                           placeholder="sk-proj-...">
                                    <small class="form-text text-muted">
                                        Required for Sora AI video generation. Get your key at 
                                        <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com</a>
                                    </small>
                                </div>

                                <div class="mb-4">
                                    <label for="replicateKey" class="form-label fw-bold">Replicate API Key</label>
                                    <input type="password" class="form-control" id="replicateKey" name="replicate_api_key" 
                                           placeholder="r8_...">
                                    <small class="form-text text-muted">
                                        For budget AI generation (e.g., Stable Video Diffusion). Get your key at 
                                        <a href="https://replicate.com/account/api-tokens" target="_blank">replicate.com</a>. 
                                        Offers a free tier with limited credits (~$0.006/sec).
                                    </small>
                                </div>

                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="showKeys">
                                    <label class="form-check-label" for="showKeys">
                                        Show API keys
                                    </label>
                                </div>
                            </div>

                            <!-- Video Settings Section -->
                            <div class="mb-5">
                                <h5 class="mb-3">üé® Video Settings</h5>

                                <div class="mb-4">
                                    <label for="bgColor" class="form-label fw-bold">Default Background Color</label>
                                    <div class="input-group">
                                        <input type="color" class="form-control form-control-color" id="bgColor" 
                                               name="background_color" value="#1e3c72" title="Choose background color">
                                        <input type="text" class="form-control" id="bgColorHex" 
                                               value="#1e3c72" placeholder="#1e3c72">
                                    </div>
                                    <small class="form-text text-muted">
                                        This color will be used as the default background for template-based videos
                                    </small>
                                </div>

                                <div class="mb-4">
                                    <label class="form-label fw-bold">Preview</label>
                                    <div id="colorPreview" style="height: 100px; border-radius: 8px; background-color: #1e3c72;"></div>
                                </div>
                            </div>

                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    üíæ Save Settings
                                </button>
                            </div>
                        </form>

                        <div id="successMessage" class="alert alert-success mt-4 d-none">
                            <strong>Success!</strong> Your settings have been saved.
                        </div>

                        <div id="errorMessage" class="alert alert-danger mt-4 d-none">
                            <strong>Error:</strong> <span id="errorText"></span>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-4">
                    <div class="card-body">
                        <h5 class="card-title">‚ÑπÔ∏è About API Keys</h5>
                        <ul class="mb-0">
                            <li><strong>OpenAI Sora:</strong> Required for AI-powered video generation. Cost: ~$0.10-$0.50 per second of video.</li>
                            <li><strong>Replicate (Stable Video Diffusion):</strong> An affordable alternative for AI video generation. Offers a free tier with limited credits. Cost: ~$0.006 per second of video.</li>
                            <li><strong>Security:</strong> Your API keys are stored securely in your browser's local storage and are never sent to our servers except when making API calls.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="/" class="nav-item">
            <div class="nav-icon">üé¨</div>
            <div class="nav-label">Generate</div>
        </a>
        <a href="/settings" class="nav-item active">
            <div class="nav-icon">‚öôÔ∏è</div>
            <div class="nav-label">Settings</div>
        </a>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/pwa.js') }}"></script>
    <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
    <script>
        // Show/hide API keys
        document.getElementById('showKeys').addEventListener('change', function() {
            const openaiKey = document.getElementById('openaiKey');
            const replicateKey = document.getElementById('replicateKey');

            if (this.checked) {
                openaiKey.type = 'text';
                replicateKey.type = 'text';
            } else {
                openaiKey.type = 'password';
                replicateKey.type = 'password';
            }
        });
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/static/sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>
</body>
</html>