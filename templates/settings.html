<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Configure settings for AI Video Ads Generator">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Video Gen">
    <title>Settings - AI Video Ads Generator</title>
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="content-wrapper">
    <div class="top-header">
        <h1 class="h5 mb-0">‚öôÔ∏è Settings</h1>
    </div>

    <div class="container my-5">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="card shadow-lg">
                    <div class="card-body p-4">
                        <h2 class="card-title mb-4">‚öôÔ∏è Settings</h2>

                        <form id="settingsForm">
                            <!-- API Keys Section -->
                            <div class="mb-5">
                                <h5 class="mb-3">üîë API Keys Configuration</h5>
                                
                                <div class="alert alert-warning">
                                    <strong>‚ö†Ô∏è Session Storage:</strong> API keys entered here are stored only for your current session and will be cleared when you close your browser or logout.
                                    <br><br>
                                    <strong>For permanent storage:</strong> Use Replit Secrets instead (üîê Secrets tab in left sidebar).
                                </div>

                                <div class="mb-4">
                                    <label for="openaiApiKey" class="form-label fw-bold">OpenAI API Key (Sora)</label>
                                    <input type="password" class="form-control" id="openaiApiKey" 
                                           name="openai_api_key" placeholder="sk-..." autocomplete="off">
                                    <small class="form-text text-muted">
                                        Leave empty to use Replit Secrets. Get key at <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com/api-keys</a>
                                    </small>
                                </div>

                                <div class="mb-4">
                                    <label for="replicateApiKey" class="form-label fw-bold">Replicate API Key</label>
                                    <input type="password" class="form-control" id="replicateApiKey" 
                                           name="replicate_api_key" placeholder="r8_..." autocomplete="off">
                                    <small class="form-text text-muted">
                                        Leave empty to use Replit Secrets. Get key at <a href="https://replicate.com/account/api-tokens" target="_blank">replicate.com/account/api-tokens</a>
                                    </small>
                                </div>

                                <div class="card">
                                    <div class="card-body">
                                        <h6 class="card-title">Cost Comparison:</h6>
                                        <ul class="mb-0">
                                            <li><strong>OpenAI (Sora):</strong> ~$0.10-$0.50/sec - High quality</li>
                                            <li><strong>Replicate:</strong> ~$0.006/sec - Free tier available, good quality</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- Video Settings Section -->
                            <div class="mb-5">
                                <h5 class="mb-3">üé® Video Settings</h5>

                                <div class="mb-4">
                                    <label for="bgColor" class="form-label fw-bold">Default Background Color</label>
                                    <div class="input-group">
                                        <input type="color" class="form-control form-control-color" id="bgColor" 
                                               name="background_color" value="#1e3c72" title="Choose background color">
                                        <input type="text" class="form-control" id="bgColorHex" 
                                               value="#1e3c72" placeholder="#1e3c72">
                                    </div>
                                    <small class="form-text text-muted">
                                        This color will be used as the default background for template-based videos
                                    </small>
                                </div>

                                <div class="mb-4">
                                    <label class="form-label fw-bold">Preview</label>
                                    <div id="colorPreview" style="height: 120px; border-radius: 12px; background-color: #1e3c72; box-shadow: 0 5px 20px rgba(0,0,0,0.15);"></div>
                                </div>
                            </div>

                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    üíæ Save Settings
                                </button>
                            </div>
                        </form>

                        <div id="successMessage" class="alert alert-success mt-4 d-none">
                            <strong>Success!</strong> Your settings have been saved.
                        </div>

                        <div id="errorMessage" class="alert alert-danger mt-4 d-none">
                            <strong>Error:</strong> <span id="errorText"></span>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-4">
                    <div class="card-body">
                        <h5 class="card-title">‚ÑπÔ∏è About Security</h5>
                        <ul class="mb-0">
                            <li><strong>üîí Secure Storage:</strong> API keys are stored server-side using Replit's encrypted Secrets management.</li>
                            <li><strong>üîê No Browser Storage:</strong> Keys never touch your browser's localStorage, protecting against XSS attacks.</li>
                            <li><strong>‚úÖ Best Practice:</strong> This is the recommended way to handle sensitive credentials in web applications.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="/" class="nav-item">
            <div class="nav-icon">üé¨</div>
            <div class="nav-label">Generate</div>
        </a>
        <a href="/settings" class="nav-item active">
            <div class="nav-icon">‚öôÔ∏è</div>
            <div class="nav-label">Settings</div>
        </a>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/pwa.js') }}"></script>
    <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/static/sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>
</body>
</html>